var pieData;
var barData;
$(document).ready(function() {
  // ======================= Pie Chart ======================
  $.ajax({
    url:'dashboards/getPieData.json',
    dataType: 'json',
    success: function(pdata){
      pieData = pdata;

      google.load('visualization', '1.0', {'packages':['corechart']});

      var data = new google.visualization.DataTable();
    
      data.addColumn('string', 'Topping');
      data.addColumn('number', 'Slices');
      data.addRows(pieData);
      
      var options = {'title':'Expense',
                     'width': 700,
                     'height': 400};

      var chartpie = new google.visualization.PieChart(document.getElementById('chart_div'));
      chartpie.draw(data, options);
    }
  });

  // ======================= Bar Chart ======================
  $.ajax({
    url:'dashboards/getBarData.json',
    dataType: 'json',
    success: function(bdata){
      bdata.unshift(["Element", "Expense", { role: "style" }]);
      barData = bdata;

      google.load('visualization', '1.0', {'packages':['corechart']});

       
      var data_bar = google.visualization.arrayToDataTable(barData);
      var view = new google.visualization.DataView(data_bar);
      view.setColumns([0, 1,
                       { calc: "stringify",
                         sourceColumn: 1,
                         type: "string",
                         role: "annotation" },
                       2]);

      var options = {
        title: "Production rate",
        width: 600,
        height: 400,
        bar: {groupWidth: "95%"},
        legend: { position: "none" },
      };
      var chart = new google.visualization.ColumnChart(document.getElementById("columnchart_values"));
      chart.draw(view, options);
    }
  });
});  

// function chartAjax(url,opt){
//   $.ajax({
//     url:url,
//     dataType: 'json',
//     success: function(data){
//       if(opt){
//         return data.unshift(["Element", "Expense", { role: "style" }]);
//         console.log(data);
//       }
//       else{
//         return data;
//         console.log(data);
//       }
        
//     }
//   });
// }

  google.load('visualization', '1.0', {'packages':['corechart']});

  google.setOnLoadCallback(drawChart);

  function drawChart() {

    // ======================= Line Chart ======================
    var data_line = google.visualization.arrayToDataTable([
      ['Year', 'Sales', 'Expenses', 'Investment'],
      ['2004',  1000, 400, 300],
      ['2005',  1170, 460, 500],
      ['2006',  660, 1120, 550],
      ['2007',  1030, 540, 700]
    ]);

      var options = {
        title: 'Company Performance',
        curveType: 'function',
        legend: { position: 'bottom' }
      };

      var line_chart = new google.visualization.LineChart(document.getElementById('curve_line_chart'));

      line_chart.draw(data_line, options);
  }